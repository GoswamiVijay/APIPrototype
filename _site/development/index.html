<!DOCTYPE html>
<html lang='en'>

  <head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta charset="utf-8">
  <title>Development - My Medication List - Prototype</title>
  <meta name="viewport" content="width=device-width">
  <link href='//fonts.googleapis.com/css?family=Raleway:400,700%7COpen+Sans:300,600' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="/APIPrototype/assets/css/main.css">
  <link rel="stylesheet" href="/APIPrototype/assets/css/syntax.css">
  <link rel="stylesheet" href="/APIPrototype/assets/css/custom.css">
  <!--[if lt IE 9]>
    <script src="/APIPrototype/assets/js/html5shiv.js"></script>
    <script src="/APIPrototype/assets/js/respond.js"></script>
  <![endif]-->
</head>


  <body>

    <div class="container">

      <header role="banner">

        <div class="wrap">
          
          <h1 class="site-title"><a class="title-link" href="/APIPrototype/">My Medication List - Prototype</a></h1>
        </div>
        
      </header>

      <div class="wrap content">

        <aside>
  <p class="intro"></p>
  <a class="skip-link visuallyhidden focusable" href="#main">Skip to Main Content</a>
  <nav class="sidebar-nav" role="navigation">
    <ul>
      
        
          <li >
            <a href="/APIPrototype/index.html"  >Introduction</a>
          </li>
        
      
        
          <li >
            <a href="/APIPrototype/how-we-built-it/"  >How we built it</a>
          </li>
        
      
        
          <li >
            <a href="/APIPrototype/methodology/"  >Methodology</a>
          </li>
        
      
        
          <li >
            <a href="/APIPrototype/design/"  >Design</a>
          </li>
        
      
        
          <li class="sidebar-nav-active">
            <a href="/APIPrototype/development/"  title='Selected'>Development</a>
          </li>
        
      
        
          <li >
            <a href="/APIPrototype/testing/"  >Testing</a>
          </li>
        
      
        
          <li >
            <a href="/APIPrototype/deployment/"  >Deployment</a>
          </li>
        
      
        
          <li >
            <a href="/APIPrototype/configuration-management/"  >Configuration Management</a>
          </li>
        
      
        
          <li >
            <a href="/APIPrototype/continuous-integration/"  >Continuous Integration</a>
          </li>
        
      
        
          <li >
            <a href="/APIPrototype/continuous-monitoring/"  >Continuous Monitoring</a>
          </li>
        
      
        
          <li >
            <a href="/APIPrototype/security/"  >Security</a>
          </li>
        
      
        
          <li >
            <a href="/APIPrototype/miscellaneous/"  >Miscellaneous</a>
          </li>
        
      
        
          <li >
            <a href="/APIPrototype/rfq-evaluation-criteria-evidence/"  >RFQ Evidence</a>
          </li>
        
      
    </ul>
  </nav>
</aside>


        <section id="main" class="main-content" role="main">
          <h1>Development</h1>
          <ul>
<li><a href="#setting-up-development-workstation">Setting up development workstation</a></li>
<li><a href="#prerequisites">Prerequisites for developing the application</a></li>
<li><a href="#repository-branches">Repository branches</a></li>
<li><a href="#development-workflow">Development workflow</a></li>
<li><a href="#building-and-running-application">Building and running the application</a></li>
<li><a href="#building-docker-images">Building and running docker images</a></li>
</ul>

<h3><a name="setting-up-development-workstation"></a>Setting up development workstation</h3>

<p>The development workstation can be either Mac or Windows based. The team uses bothe, Apple Mac (Mac) and Windows workstation for developing the application. A Mac is preferred due to low friction in getting the prerequisites installed, availability of package manager for installing applications. The following instructions assume you have a Mac based workstation. Instructions that are windows specific will be pointed out (???todo???)</p>

<h3>Basic setup</h3>

<ol>
<li><p>Install XCode and OS X Command Line Tools
reference - <a href="https://developer.apple.com/xcode/downloads/">https://developer.apple.com/xcode/downloads/</a></p></li>
<li><p>Use the instructions from here <a href="https://github.com/18F/laptop">https://github.com/18F/laptop</a> to setup your developer box with the required software 
$ curl --remote-name <a href="https://raw.githubusercontent.com/18F/laptop/master/mac">https://raw.githubusercontent.com/18F/laptop/master/mac</a>
$ bash mac 2&gt;&amp;1 | tee ~/laptop.log</p></li>
<li><p>Install mongo</p></li>
</ol>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ brew install mongodb
</code></pre></div>
<p>reference - <a href="http://docs.mongodb.org/manual/tutorial/install-mongodb-on-os-x/">http://docs.mongodb.org/manual/tutorial/install-mongodb-on-os-x/</a></p>

<ol>
<li><p>Install Sourcetree 
reference - <a href="https://www.sourcetreeapp.com/download/">https://www.sourcetreeapp.com/download/</a></p></li>
<li><p>Install Virtual box</p></li>
</ol>

<p>reference - <a href="https://www.virtualbox.org/wiki/Downloads">https://www.virtualbox.org/wiki/Downloads</a></p>

<ol>
<li>Install boot2docker</li>
</ol>

<p>reference - <a href="http://boot2docker.io/">http://boot2docker.io/</a>
Instructions - <a href="https://docs.docker.com/installation/mac/">https://docs.docker.com/installation/mac/</a></p>

<ol>
<li>Install Textwrangler</li>
</ol>

<p>reference - <a href="http://www.barebones.com/products/textwrangler/">http://www.barebones.com/products/textwrangler/</a></p>

<ol>
<li>Install mongo gui client</li>
</ol>

<p>reference - <a href="http://robomongo.org/">http://robomongo.org/</a></p>

<p>Install VirtualBox - <a href="https://www.virtualbox.org/wiki/Downloads">https://www.virtualbox.org/wiki/Downloads</a></p>

<ol>
<li> Install ruby gems for working on documentation branch (gh-pages)</li>
</ol>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ gem install jekyll
$ gem install kramdown
</code></pre></div>
<ol>
<li>Install grunt</li>
</ol>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ npm install -g grunt-cli
</code></pre></div>
<p>reference - <a href="https://github.com/cfpb/DOCter/blob/gh-pages/README.md">https://github.com/cfpb/DOCter/blob/gh-pages/README.md</a></p>

<p>Optional - You can use <a href="http://www.sublimetext.com/">sublime</a> , <a href="http://www.barebones.com/products/textwrangler/">TextWrangler</a> or <a href="https://www.jetbrains.com/webstorm/">webstorm</a></p>

<p><em>If you find yourself having to use sudo for running node, please see this page on how to resolve the issue <a href="http://stackoverflow.com/questions/16151018/npm-throws-error-without-sudo">http://stackoverflow.com/questions/16151018/npm-throws-error-without-sudo</a></em></p>

<p>If you haven&#39;t done so already, please create an account on github, dockerhub 
The project administrator should also add you to the project team on github, dockerhub, codeship, Jira, confluence and Amazon Cloud</p>

<h2><a name="prerequisites"></a>Prerequisites for developing the application</h2>

<p>It is assumed you have the editor, and development environment mentioned above already setup.
If you are new to git please use the following resources to learn git and gitflow
<a href="https://git-scm.com/book/en/v1/Getting-Started">git</a>
<a href="https://www.atlassian.com/git/tutorials/comparing-workflows/feature-branch-workflow">gitflow</a>
<a href="https://help.github.com/articles/using-jekyll-with-pages/">github pages</a>
<a href="http://blog.sourcetreeapp.com/2012/08/01/smart-branching-with-sourcetree-and-git-flow/">git branching</a></p>

<p><em>if you are using the command line to work with github, please use good judgement before merging and/or rebasing. <a href="https://www.google.com/">Google</a> or <a href="http://stackoverflow.com/">SO</a> are your friends.</em></p>

<h2><a name="repository-branches"></a>Repository branches</h2>

<p>Please refer to <a href="/APIPrototype/configuration-management/#branches">Configuration Management - branches</a> for details source code branching. </p>

<p>Use the develop branch for development, bug fixes and enhancement unless you are working on a feature or a patch in which case a branch will be created for you by the scrum master or configuration manager. </p>

<p>The master branch is used for releasing to production. Please do not check in code into this branch. Sprint testing and UAT is done on the test branch. Code is deployed daily to dev-integration branch. Please use the dev-integration branch to verify development is complete before closing the ticket.</p>

<p>To clone the develop branch of the repository on your desktop use the following command from Terminal </p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ clone https://github.com/GoswamiVijay/APIPrototype.git
</code></pre></div>
<p>To checkout the develop branch</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ cd APIPrototype
$ git checkout -b develop
</code></pre></div>
<h2><a name="development-workflow"></a>Development workflow</h2>

<p>The development workflow is pretty simple</p>

<ol>
<li><p>If you are working on a an issue, please make sure the the issue is recorded in Jira or Github issues list and is in the current sprint (if not, create the ticket/issue and and/or move it to current sprint)</p></li>
<li><p>When closing the issue, reference the ticket number in the commit message, this allows for referencing the files that were modified when the issue was resolved.</p></li>
<li><p>Only check in working code, use <a href="http://git-scm.com/docs/git-stash">stash</a> to switch work branches or suspend the current activity.</p></li>
<li><p>Err on the side of more documentation. If there are configuration settings your are adding or dependecies or steps for building or testing the application, pleas record it in confluence and/or github pages</p></li>
</ol>

<h2><a name="building-and-running-application"></a>Building and running the application</h2>

<ol>
<li> Start mongodb database using the following command in terminal window</li>
</ol>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ sudo mongod
</code></pre></div>
<ol>
<li> Run the application
In a new terminal window, navigate to the folder where you have cloned the repository and run the following command</li>
</ol>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ nodemon
</code></pre></div>
<h2><a name="building-docker-images"></a>Building and running docker images</h2>

<p>The following instructions for building the docker images assume you have checked out the develop branch on your workstation and in terminal/command prompt in that folder. If you are running boot2docker, it is assumed you are in the boot2docker shell (run boot2docker from Application folder on mac). Substitute your account name with goswamivijay when building or running the images</p>

<p><strong>Build mongo db image</strong></p>

<p>Navigate to Docker-db folder (this is one level down from the application folder)</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ cd Docker-db
</code></pre></div>
<p>run the following command to build the image</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ docker build -t goswamivijay/apiprototype-db-develop .
</code></pre></div>
<p>Verify image exist by running the following command. You should see the image listed.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ docker images
</code></pre></div>
<p><strong>Build webapp images</strong></p>

<p>Navigate to application folder (this is the folder where you checked out the repository)</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ docker build -t goswamivijay/apiprototype-web-develop .
</code></pre></div>
<p>Verify image exist by running</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ docker images
</code></pre></div>
<p>Navigate to Docker-nginx folder (this is one level down from the application folder)</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ cd Docker-nginx
</code></pre></div>
<p>run the following command to build the image</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ docker build -t goswamivijay/apiprototype-nginx-develop .
</code></pre></div>
<p>Verify image exist by running the following command. You should see the image listed.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ docker images
</code></pre></div>
<p>Once you have the docker images you can run the images</p>

<p>Run database server</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">docker run -p 27017:27017 --name mymedlookupdb -d goswamivijay/apiprototype-db-develop
</code></pre></div>
<p><em>please note the container id that is displayed after you run the command, we will refer to it as the database container id.</em></p>

<p>Run web  server</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">docker run -p 4000:4000 --name mymedlookupweb1 -d --link mymedlookupdb:mymedlookupdb goswamivijay/apiprototype-web-develop 
</code></pre></div>
<p><em>please note the container id that is displayed after you run the command, we will refer to it as the web container id.</em></p>

<p>Navigate to http://&lt;<em>server address</em>&gt;:4000/ in your browser</p>

<p>To find the &lt;<em>server address</em>&gt; if you are running boot2docker, enter the following command</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ boot2docker ip 
</code></pre></div>
<p>To stop the containers, run the following command</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ docker stop &lt;web container id&gt;
$ docker stop &lt;db container id&gt;
</code></pre></div>
<p><em>the web container id and the web container id are the ids that were diplayed when you used the run command.</em>
If you don&#39;t have the container id, you can query the conatiner id by running the following command</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ docker stop ps
</code></pre></div>
<p>The container id will be listed with the corresponding name of the container (mymedlookupweb1 for web and mymedlookupdb for database)</p>

<p>Refer to /APIPrototype/testing/ for details on running the docker images. Use the following references to learn more about running docker images locally.</p>

<p><a href="https://docs.docker.com/userguide/">https://docs.docker.com/userguide/</a>
<a href="https://docs.docker.com/reference/builder/">https://docs.docker.com/reference/builder/</a></p>

<p>Alternatively, you can use the docker-compose commands to build and run the images/containers </p>

<p>To build all the images, start boot2docker and navigate to the folder where you have cloned the repository. Run the following command to build all the images </p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ docker-compose build
</code></pre></div>
<p>Run the containers</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ docker-compose up -d
</code></pre></div>
<p>To find the port numbers the containers are listening on</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ docker ps
</code></pre></div>
<p>You can now navigate to the nginx url or the web application containers to test the application. To find the ip address use the the following command.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ boot2docker ip
</code></pre></div>
<p>The browser response might be slow by few seconds the first time you run the containers.</p>

<p>To remove the containers use the following command</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ docker-compose rm
</code></pre></div>
<p>Optional -- you can use the -v option to map your working folder to the container so changes in your folder are reflected in the application.</p>

        </section>

      </div><!-- /.wrap content -->

      <footer role="contentinfo">
  <div class="wrap">
    <p>This project is maintained by <a href="http://www.xfinion.com">Xfinion</a>.</p>

    </div><!--/.wrap -->
</footer>


    </div> <!-- /.container -->

    <!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-64764688-1', 'gsa.gov');

  // anonymize user IPs (chops off the last IP triplet)
  ga('set', 'anonymizeIp', true);

  ga('send', 'pageview');
</script>

<!-- Digital Analytics Program roll-up, see https://analytics.usa.gov for data -->
<script id="_fed_an_ua_tag" src="https://analytics.usa.gov/dap/dap.min.js" async></script>

    <script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
<script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script>





  </body>

</html>
